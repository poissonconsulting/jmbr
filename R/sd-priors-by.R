#' @export
sd_priors_by.jmb_code <- function(x, by = 2, ...) {
  check_scalar(by, c(0.1, 10))
  check_unused(...)

  x <- rm_comments(x)
  x <- gsub(
    "(~\\s*dl{0,1}norm\\s*[(][^,)]+,\\s*)((\\d+[.]{0,1}\\d*)|(\\d*[.]{0,1}\\d+))(\\s*\\^\\s*-\\s*2\\s*)([)])",
    str_c("\\1(\\2 * ", by, ")^-2\\6"), x)
  x <- gsub(
    "(~\\s*ddexp\\s*[(][^,)]+,\\s*)((\\d+[.]{0,1}\\d*)|(\\d*[.]{0,1}\\d+))(\\s*\\^\\s*-\\s*2\\s*)([)])",
    str_c("\\1(\\2 * ", by, ")^-2\\6"), x)
  x <- gsub(
    "(~\\s*dlogis\\s*[(][^,)]+,\\s*)((\\d+[.]{0,1}\\d*)|(\\d*[.]{0,1}\\d+))(\\s*\\^\\s*-\\s*2\\s*)([)])",
    str_c("\\1(\\2 * ", by, ")^-2\\6"), x)
  x <- gsub(
    "(~\\s*dn{0,1}t\\s*[(][^,)]+,\\s*)((\\d+[.]{0,1}\\d*)|(\\d*[.]{0,1}\\d+))(\\s*\\^\\s*-\\s*2\\s*)(,[^,)]+[)])",
    str_c("\\1(\\2 * ", by, ")^-2\\6"), x)

  mb_code(x)
}
